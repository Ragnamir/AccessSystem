Название: Отслеживание текущего состояния пользователя (optimistic lock)

Требования

- Таблица user_state с полем version для оптимистичной блокировки.
- Репозиторий и сервис обновления зоны пользователя.

Тесты

- Тест оптимистичной блокировки (конкурентные обновления).

Документация

- Описание инвариантов состояния (зона OUT, вход/выход) в docs/state.md.

Готово, когда

- Состояние обновляется корректно, гонки предотвращены; тесты зелёные.


